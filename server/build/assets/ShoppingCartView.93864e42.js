import{_ as h,o as n,a as i,e,t as r,N as p,H as v,I as w,r as u,d as f,w as g,F as y,b as I,c as b,T as C,O as P,f as A,m as $,g as G}from"./index.a60cd40e.js";const S={props:["gameTitle","gamePoster","gamePrice","gameAmount","totalPrice","gameId","platformId","gamePlatform"],emits:["changeAmountChild","deleteItemChild"]},k={class:"flex sm:flex-row flex-col w-full sm:h-24 sm:justify-between items-center rounded-xl inner_shadow_custom overflow-hidden text-2xl p-5 sm:p-0 relative"},T=e("img",{src:p,class:"sm:w-3 sm:h-3 w-5 h-5",alt:"delete"},null,-1),q=[T],D={class:"sm:w-2/12 w-full h-48 sm:h-full mb-5 sm:mb-0"},E=["src","alt"],j={class:"sm:w-4/12 mb-5 sm:mb-0"},B={class:"text-center"},F={class:"flex flex-col sm:flex-row items-center sm:justify-between sm:w-6/12 sm:pr-14"},N={class:"flex items-center justify-between sm:w-96 w-36 mb-3 sm:mb-0"},V=e("img",{src:v,alt:"minus"},null,-1),M=[V],L=e("img",{src:w,alt:"plus"},null,-1),O=[L],R={class:"w-full mb-3 sm:mb-0"},H=e("h1",{class:"text-center sm:font-bold sm:text-2xl sm:hidden"},"Price",-1),Y=e("hr",{class:"w-1/2 m-auto mb-2 h-0.5 bg-custom-red border-none sm:hidden"},null,-1),z={class:"text-center"},J={class:"w-full mb-3 sm:mb-0"},K=e("h1",{class:"text-center sm:font-bold sm:text-2xl sm:hidden"},"Platform",-1),Q=e("hr",{class:"w-1/2 m-auto mb-2 h-0.5 bg-custom-red border-none sm:hidden"},null,-1),U={class:"text-center"},W={class:"w-full"},X=e("h1",{class:"text-center sm:font-bold sm:text-2xl sm:hidden"},"Total",-1),Z=e("hr",{class:"w-1/2 m-auto mb-2 h-0.5 bg-custom-red border-none sm:hidden"},null,-1),ee={class:"text-center"};function te(s,t,o,_,d,m){return n(),i("div",k,[e("button",{class:"absolute top-2 right-2",onClick:t[0]||(t[0]=l=>s.$emit("deleteItemChild",o.gameId))},q),e("div",D,[e("img",{class:"w-full h-full rounded-xl sm:rounded-none object-cover",src:o.gamePoster,alt:o.gameTitle},null,8,E)]),e("div",j,[e("h1",B,r(o.gameTitle),1)]),e("div",F,[e("div",N,[e("button",{onClick:t[1]||(t[1]=l=>s.$emit("changeAmountChild",{amount:o.gameAmount>1?o.gameAmount-=1:!1,gameId:o.gameId,platformId:o.platformId}))},M),e("h1",null,r(o.gameAmount),1),e("button",{onClick:t[2]||(t[2]=l=>s.$emit("changeAmountChild",{amount:o.gameAmount<10?o.gameAmount+=1:!1,gameId:o.gameId,platformId:o.platformId}))},O)]),e("div",R,[H,Y,e("h1",z,r(o.gamePrice)+" $",1)]),e("div",J,[K,Q,e("h1",U,r(o.gamePlatform),1)]),e("div",W,[X,Z,e("h1",ee,r(o.totalPrice)+" $",1)])])])}var se=h(S,[["render",te]]);const oe={components:{CartItem:se},emits:["changeAmountParent","deleteItemParent","buyGamesEmit"],props:["gamesInfo"],computed:{totalSum(){return this.gamesInfo.orderInfos.reduce((s,t)=>s+t.quantity*t.game.price,0)}}},ae={class:"p-5 custom_shadow_out rounded"},me=P('<h1 class="mb-10 text-2xl font-bold uppercase">Shopping cart</h1><div class="hidden sm:block"><div class="flex mb-3 text-center text-2xl font-bold"><div class="sm:w-6/12 mb-5 sm:mb-0"><h1 class="text-center">Item</h1></div><div class="flex flex-col sm:flex-row items-center sm:justify-between sm:w-6/12 sm:pr-14"><div class="flex items-center justify-center sm:w-96 w-36 mb-3 sm:mb-0"><h1>Amount</h1></div><div class="w-full mb-3 sm:mb-0"><h1 class="text-center">Price</h1></div><div class="w-full mb-3 sm:mb-0"><h1 class="text-center">Platform</h1></div><div class="w-full"><h1 class="text-center">Total</h1></div></div></div><hr class="w-full h-0.5 bg-custom-red border-none hidden sm:block"></div>',2),ne={class:"mt-10"},le={key:1},re=e("p",{class:"text-2xl text-center my-16"},"Your cart is empty",-1),ie=[re],de={class:"flex items-center sm:justify-end justify-between"},ce={class:"sm:pr-10"},ue=A(" Order and payment "),he={class:"sm:px-5 px-3 py-2 font-bold text-2xl text-custom-red rounded inner_shadow_custom"};function _e(s,t,o,_,d,m){const l=u("CartItem"),x=u("CustomBtn");return n(),i("div",ae,[me,e("div",ne,[f(C,{name:"list",tag:"ul"},{default:g(()=>[o.gamesInfo.orderInfos.length!=0?(n(!0),i(y,{key:0},I(o.gamesInfo.orderInfos,a=>(n(),b(l,{class:"mb-5","game-title":a.game.gameTitle,"game-poster":a.game.poster,"game-price":a.game.price,"game-amount":a.quantity,"game-platform":a.platform.platformName,"total-price":a.game.price*a.quantity,"game-id":a.gameId,"platform-id":a.platformId,key:a.gameId,onChangeAmountChild:t[0]||(t[0]=c=>s.$emit("changeAmountParent",c)),onDeleteItemChild:t[1]||(t[1]=c=>s.$emit("deleteItemParent",c))},null,8,["game-title","game-poster","game-price","game-amount","game-platform","total-price","game-id","platform-id"]))),128)):(n(),i("div",le,ie))]),_:1})]),e("div",de,[e("div",ce,[f(x,{onClick:t[2]||(t[2]=a=>m.totalSum>0?s.$emit("buyGamesEmit",{cartId:o.gamesInfo.id,totalSum:m.totalSum}):!1),class:"bg-custom-red text-xl text-white"},{default:g(()=>[ue]),_:1})]),e("div",he,[e("strong",null,r(m.totalSum)+" $",1)])])])}var fe=h(oe,[["render",_e]]);const ge={name:"ShoppingCartView",components:{CartComponent:fe},data(){return{cartGames:null,reqDelay:null}},computed:$("isLoadingModule",["getLoadingStatus"]),methods:{async changeAmount(s){try{if(!s.amount)return;const t={cartId:this.cartGames.id,gameId:s.gameId,platformId:s.platformId,amount:s.amount},o=(await this.$API.userServices.changeAmount(t)).data;this.reqDelay=null,this.cartGames=o}catch(t){this.$store.commit("alertInfoModule/updateError",t)}},setupFunc(s){typeof this.reqDelay=="number"&&this.cancelRequest(),this.reqDelay=setTimeout(()=>{this.changeAmount(s)},300)},cancelRequest(){clearTimeout(this.reqDelay)},async buyGames(s){try{this.$router.push({name:"home"});const{message:t}=(await this.$API.userServices.buyGames(s.cartId,{totalPrice:s.totalSum})).data;this.$store.commit("alertInfoModule/updateAlert",t)}catch(t){this.$store.commit("alertInfoModule/updateError",t)}},async deleteGameFromCart(s){try{const t=(await this.$API.userServices.deleteFromCart(s)).data;this.cartGames=t}catch(t){this.$store.commit("alertInfoModule/updateError",t)}}},async mounted(){try{this.cartGames=(await this.$API.userServices.getCartGames()).data}catch(s){this.$store.commit("alertInfoModule/updateError",s)}}};function be(s,t,o,_,d,m){const l=u("CartComponent");return n(),i("div",null,[d.cartGames?(n(),b(l,{key:0,"games-info":d.cartGames,onChangeAmountParent:m.setupFunc,onDeleteItemParent:m.deleteGameFromCart,onBuyGamesEmit:m.buyGames},null,8,["games-info","onChangeAmountParent","onDeleteItemParent","onBuyGamesEmit"])):G("",!0)])}var pe=h(ge,[["render",be]]);export{pe as default};
